import{r,j as e,A as P,m as $,t as X,P as F}from"./index-DfHiWpns.js";import{d as K}from"./resourceSummary-CLv5rrj4.js";import{V as O}from"./VirtualizedList-CCFgsQ_9.js";import{L as U,M as Z}from"./MathFormulaEditor-B9qpQx-l.js";function J({items:s,searchFields:i,onSearch:j,placeholder:m="智能搜索...",className:A="",showSuggestions:v=!0,maxSuggestions:c=5,debounceMs:g=300,minQueryLength:k=1}){const[l,f]=r.useState(""),[b,u]=r.useState(""),[h,w]=r.useState([]),[n,y]=r.useState(!1),[a,o]=r.useState([]),[S,T]=r.useState(!1);r.useEffect(()=>{const d=setTimeout(()=>{u(l)},g);return()=>clearTimeout(d)},[l,g]);const E=r.useCallback((d,C)=>{const M=d.toLowerCase(),N=C.toLowerCase();if(M.includes(N)){const p=M.indexOf(N);return{score:1,indices:[[p,p+N.length]]}}let I=0,z=0;const t=[];let x=-1;for(let p=0;p<M.length&&z<N.length;p++)M[p]===N[z]?(x===-1&&(x=p),z++,z===N.length&&(t.push([x,p+1]),I=.7*(N.length/d.length))):x!==-1&&(t.push([x,p]),x=-1);return{score:I,indices:t}},[]),H=r.useCallback(d=>{if(!d||d.length<k)return[];const C=[];return s.forEach(M=>{let N=0;const I=[];i.forEach(({key:z,weight:t,fuzzy:x=!1})=>{const p=String(M[z]||"");if(x){const R=E(p,d);R.score>0&&(N+=R.score*t,I.push({field:String(z),value:p,indices:R.indices}))}else{const R=p.toLowerCase(),W=d.toLowerCase();if(R.includes(W)){const G=R===W,Y=R.startsWith(W);N+=(G?1:Y?.8:.5)*t;const _=R.indexOf(W);I.push({field:String(z),value:p,indices:[[_,_+W.length]]})}}}),N>0&&C.push({item:M,score:N,matches:I})}),C.sort((M,N)=>N.score-M.score)},[s,i,k,E]),V=r.useCallback(d=>{if(!d||d.length<2)return[];const C=new Set;return a.forEach(M=>{M.toLowerCase().includes(d.toLowerCase())&&C.add(M)}),s.forEach(M=>{i.forEach(({key:N})=>{String(M[N]||"").split(/\s+/).forEach(t=>{t.toLowerCase().includes(d.toLowerCase())&&t.length>2&&C.add(t)})})}),Array.from(C).slice(0,c)},[s,i,a,c]);r.useEffect(()=>{if(b){T(!0);const d=H(b);j(d,b),b.length>=2&&o(C=>[b,...C.filter(N=>N!==b)].slice(0,10)),T(!1)}else j([],"")},[b,H,j]),r.useEffect(()=>{if(v&&l){const d=V(l);w(d)}else w([])},[l,v,V]);const q=d=>{const C=d.target.value;f(C),y(C.length>0&&v)},B=d=>{f(d),y(!1)},L=d=>{d.key==="Escape"&&y(!1)},D=()=>{f(""),y(!1)};return e.jsxs("div",{className:`relative ${A}`,children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:S?e.jsx("div",{className:"w-4 h-4 border-2 border-gray-300 rounded-full animate-spin border-t-blue-600"}):e.jsx("i",{className:"text-gray-400 fa-solid fa-search"})}),e.jsx("input",{type:"text",value:l,onChange:q,onKeyDown:L,onFocus:()=>y(l.length>0&&v),placeholder:m,className:"block w-full py-3 pl-10 pr-10 bg-white border border-gray-300 rounded-lg shadow-sm dark:border-gray-700 dark:bg-gray-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}),l&&e.jsx("button",{onClick:D,className:"absolute inset-y-0 right-0 flex items-center pr-3 text-gray-400 hover:text-gray-600",children:e.jsx("i",{className:"fa-solid fa-times"})})]}),e.jsx(P,{children:n&&h.length>0&&e.jsx($.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg dark:bg-gray-800 dark:border-gray-700",children:e.jsx("div",{className:"py-1",children:h.map((d,C)=>e.jsxs("button",{onClick:()=>B(d),className:"flex items-center w-full px-4 py-2 text-left text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700",children:[e.jsx("i",{className:"mr-3 text-gray-400 fa-solid fa-history"}),e.jsx("span",{children:d})]},C))})})}),b&&e.jsxs("div",{className:"mt-2 text-xs text-gray-500 dark:text-gray-400",children:['搜索 "',b,'"',S?" 搜索中...":""]})]})}function Q({data:s,width:i=300,height:j=300,className:m="",showLabels:A=!0,showValues:v=!0,animated:c=!0}){const g=r.useRef(null),k=i/2,l=j/2,f=Math.min(i,j)/2-40,b=r.useMemo(()=>{const u=s.reduce((w,n)=>w+n.value,0);let h=-90;return s.map((w,n)=>{const y=w.value/u*100,a=w.value/u*360,o=h,S=h+a,T=o*Math.PI/180,E=S*Math.PI/180,H=k+f*Math.cos(T),V=l+f*Math.sin(T),q=k+f*Math.cos(E),B=l+f*Math.sin(E),L=a>180?1:0,D=[`M ${k} ${l}`,`L ${H} ${V}`,`A ${f} ${f} 0 ${L} 1 ${q} ${B}`,"Z"].join(" "),C=(o+S)/2*Math.PI/180,M=f*.7,N=k+M*Math.cos(C),I=l+M*Math.sin(C);return h=S,{...w,pathData:D,percentage:y,labelX:N,labelY:I,color:w.color||`hsl(${n*360/s.length}, 70%, 60%)`}})},[s,k,l,f]);return e.jsxs("div",{className:`inline-block ${m}`,children:[e.jsx("svg",{ref:g,width:i,height:j,className:"overflow-visible",children:b.map((u,h)=>e.jsxs("g",{children:[e.jsx($.path,{d:u.pathData,fill:u.color,stroke:"white",strokeWidth:"2",initial:c?{scale:0}:void 0,animate:c?{scale:1}:void 0,transition:c?{delay:h*.1,duration:.5}:void 0,className:"cursor-pointer hover:opacity-80"}),A&&u.percentage>5&&e.jsx($.text,{x:u.labelX,y:u.labelY,textAnchor:"middle",dominantBaseline:"middle",className:"text-xs font-medium fill-white",initial:c?{opacity:0}:void 0,animate:c?{opacity:1}:void 0,transition:c?{delay:h*.1+.3}:void 0,children:v?`${u.percentage.toFixed(1)}%`:u.label})]},h))}),e.jsx("div",{className:"mt-4 space-y-2",children:b.map((u,h)=>e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:u.color}}),e.jsxs("span",{className:"text-gray-700 dark:text-gray-300",children:[u.label,": ",u.value," (",u.percentage.toFixed(1),"%)"]})]},h))})]})}function ee({data:s,width:i=400,height:j=300,className:m="",showLabels:A=!0,showValues:v=!0,animated:c=!0}){const g={top:20,right:20,bottom:40,left:40},k=i-g.left-g.right,l=j-g.top-g.bottom,f=Math.max(...s.map(h=>h.value)),b=k/s.length*.8,u=k/s.length*.2;return e.jsx("div",{className:`inline-block ${m}`,children:e.jsx("svg",{width:i,height:j,children:e.jsxs("g",{transform:`translate(${g.left}, ${g.top})`,children:[e.jsx("line",{x1:0,y1:0,x2:0,y2:l,stroke:"currentColor",className:"text-gray-400"}),e.jsx("line",{x1:0,y1:l,x2:k,y2:l,stroke:"currentColor",className:"text-gray-400"}),s.map((h,w)=>{const n=h.value/f*l,y=w*(b+u)+u/2,a=l-n;return e.jsxs("g",{children:[e.jsx($.rect,{x:y,y:a,width:b,height:n,fill:h.color||`hsl(${w*360/s.length}, 70%, 60%)`,initial:c?{height:0,y:l}:void 0,animate:c?{height:n,y:a}:void 0,transition:c?{delay:w*.1,duration:.5}:void 0,className:"cursor-pointer hover:opacity-80"}),v&&e.jsx($.text,{x:y+b/2,y:a-5,textAnchor:"middle",className:"text-xs font-medium text-gray-700 fill-current dark:text-gray-300",initial:c?{opacity:0}:void 0,animate:c?{opacity:1}:void 0,transition:c?{delay:w*.1+.3}:void 0,children:h.value}),A&&e.jsx("text",{x:y+b/2,y:l+15,textAnchor:"middle",className:"text-xs text-gray-600 fill-current dark:text-gray-400",children:h.label})]},w)})]})})})}function te({data:s,width:i=400,height:j=300,className:m="",showLabels:A=!0,showValues:v=!0,animated:c=!0}){const g={top:20,right:20,bottom:40,left:40},k=i-g.left-g.right,l=j-g.top-g.bottom,f=Math.max(...s.map(n=>n.value)),b=Math.min(...s.map(n=>n.value)),u=f-b,h=s.map((n,y)=>{const a=y/(s.length-1)*k,o=l-(n.value-b)/u*l;return{x:a,y:o,...n}}),w=h.map((n,y)=>`${y===0?"M":"L"} ${n.x} ${n.y}`).join(" ");return e.jsx("div",{className:`inline-block ${m}`,children:e.jsx("svg",{width:i,height:j,children:e.jsxs("g",{transform:`translate(${g.left}, ${g.top})`,children:[[0,.25,.5,.75,1].map((n,y)=>e.jsx("line",{x1:0,y1:l*n,x2:k,y2:l*n,stroke:"currentColor",strokeDasharray:"2,2",className:"text-gray-200 dark:text-gray-700"},y)),e.jsx("line",{x1:0,y1:0,x2:0,y2:l,stroke:"currentColor",className:"text-gray-400"}),e.jsx("line",{x1:0,y1:l,x2:k,y2:l,stroke:"currentColor",className:"text-gray-400"}),e.jsx($.path,{d:w,fill:"none",stroke:"#3B82F6",strokeWidth:"2",initial:c?{pathLength:0}:void 0,animate:c?{pathLength:1}:void 0,transition:c?{duration:1}:void 0}),h.map((n,y)=>e.jsxs("g",{children:[e.jsx($.circle,{cx:n.x,cy:n.y,r:"4",fill:"#3B82F6",initial:c?{scale:0}:void 0,animate:c?{scale:1}:void 0,transition:c?{delay:y*.1+.5}:void 0,className:"cursor-pointer hover:r-6"}),v&&e.jsx($.text,{x:n.x,y:n.y-10,textAnchor:"middle",className:"text-xs font-medium text-gray-700 fill-current dark:text-gray-300",initial:c?{opacity:0}:void 0,animate:c?{opacity:1}:void 0,transition:c?{delay:y*.1+.7}:void 0,children:n.value})]},y)),A&&h.map((n,y)=>e.jsx("text",{x:n.x,y:l+15,textAnchor:"middle",className:"text-xs text-gray-600 fill-current dark:text-gray-400",children:n.label},y))]})})})}function ae({progressData:s,className:i=""}){const j=s.map(m=>({label:m.topic,value:Math.round(m.completed/m.total*100),category:m.category,color:m.category==="基础"?"#10B981":m.category==="进阶"?"#3B82F6":"#8B5CF6"}));return e.jsxs("div",{className:`p-6 bg-white rounded-lg shadow-lg dark:bg-gray-800 ${i}`,children:[e.jsx("h3",{className:"mb-4 text-lg font-semibold text-gray-900 dark:text-white",children:"学习进度统计"}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 lg:grid-cols-2",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"mb-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:"完成度分布"}),e.jsx(Q,{data:j,width:250,height:250})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"mb-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:"各主题进度"}),e.jsx(ee,{data:j,width:300,height:250})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"mb-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:"学习趋势"}),e.jsx(te,{data:j.map((m,A)=>({...m,label:`第${A+1}周`})),width:600,height:200})]})]})}function se({items:s,userProfile:i,maxRecommendations:j=6,className:m="",onItemClick:A,onFeedback:v}){const[c,g]=r.useState("all"),[k,l]=r.useState(!1),f=r.useMemo(()=>s.filter(o=>!i.completedItems.includes(o.id)).map(o=>{let S=0;const T=o.difficulty===i.currentLevel?1:i.currentLevel==="beginner"&&o.difficulty==="intermediate"?.7:i.currentLevel==="intermediate"&&o.difficulty==="beginner"?.8:i.currentLevel==="intermediate"&&o.difficulty==="advanced"?.6:i.currentLevel==="advanced"&&o.difficulty==="intermediate"?.9:.3;S+=T*.25;const E=i.interests.some(L=>o.tags.includes(L)||o.category===L)?1:0;S+=E*.2;const H=i.learningGoals.some(L=>o.tags.includes(L)||o.category===L)?1:0;S+=H*.15;const V=o.estimatedTime<=i.timePreference?1:o.estimatedTime<=i.timePreference*1.5?.7:.3;S+=V*.1;const q=i.weakAreas.some(L=>o.category===L||o.tags.includes(L))?1:0;S+=q*.15;const B=!o.prerequisites||o.prerequisites.every(L=>i.completedItems.includes(L));return S+=B?.1:0,S+=o.relevanceScore*.05,{...o,finalScore:S}}).sort((o,S)=>S.finalScore-o.finalScore).slice(0,j),[s,i,j]),b=r.useMemo(()=>["all",...Array.from(new Set(f.map(o=>o.category)))],[f]),u=r.useMemo(()=>c==="all"?f:f.filter(a=>a.category===c),[f,c]),h=a=>{switch(a){case"beginner":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200";case"intermediate":return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200";case"advanced":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200";default:return"bg-gray-100 text-gray-800 dark:bg-gray-900 dark:text-gray-200"}},w=a=>{switch(a){case"symbol":return"fa-solid fa-at";case"formula":return"fa-solid fa-calculator";case"concept":return"fa-solid fa-lightbulb";case"exercise":return"fa-solid fa-dumbbell";default:return"fa-solid fa-book"}},n=a=>{switch(a){case"beginner":return"初级";case"intermediate":return"中级";case"advanced":return"高级";default:return"未知"}},y=a=>{switch(a){case"symbol":return"符号";case"formula":return"公式";case"concept":return"概念";case"exercise":return"练习";default:return"其他"}};return e.jsxs("div",{className:`p-6 bg-white rounded-lg shadow-lg dark:bg-gray-800 ${m}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:"智能推荐"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"基于您的学习进度和偏好为您推荐合适的内容"})]}),e.jsx("button",{onClick:()=>l(!k),className:"p-2 text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",title:"查看推荐算法说明",children:e.jsx("i",{className:"fa-solid fa-info-circle"})})]}),e.jsx(P,{children:k&&e.jsxs($.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"p-4 mb-6 rounded-lg bg-blue-50 dark:bg-blue-900/20",children:[e.jsx("h4",{className:"mb-2 text-sm font-semibold text-blue-800 dark:text-blue-200",children:"推荐算法说明"}),e.jsxs("div",{className:"space-y-1 text-xs text-blue-700 dark:text-blue-300",children:[e.jsx("div",{children:"• 难度匹配 (25%): 根据您的当前水平推荐合适难度的内容"}),e.jsx("div",{children:"• 兴趣匹配 (20%): 基于您的兴趣标签进行推荐"}),e.jsx("div",{children:"• 学习目标 (15%): 与您的学习目标相关的内容"}),e.jsx("div",{children:"• 弱项补强 (15%): 重点推荐您需要加强的领域"}),e.jsx("div",{children:"• 时间匹配 (10%): 符合您的学习时间偏好"}),e.jsx("div",{children:"• 前置条件 (10%): 确保您已掌握必要的前置知识"}),e.jsx("div",{children:"• 基础相关性 (5%): 内容本身的质量和相关性"})]})]})}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:b.map(a=>e.jsx("button",{onClick:()=>g(a),className:`px-3 py-1 text-sm rounded-full transition-colors ${c===a?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"}`,children:a==="all"?"全部":a},a))}),e.jsx("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2 lg:grid-cols-3",children:u.map((a,o)=>e.jsxs($.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:o*.1},className:"p-4 transition-shadow border border-gray-200 rounded-lg hover:shadow-md dark:border-gray-700 dark:hover:border-gray-600",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("i",{className:`${w(a.type)} text-blue-600 dark:text-blue-400`}),e.jsx("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:y(a.type)})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${h(a.difficulty)}`,children:n(a.difficulty)}),e.jsxs("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:[Math.round(a.finalScore*100),"%"]})]})]}),e.jsx("h4",{className:"mb-2 text-sm font-semibold text-gray-900 dark:text-white line-clamp-2",children:a.title}),e.jsx("p",{className:"mb-3 text-xs text-gray-600 dark:text-gray-400 line-clamp-3",children:a.description}),e.jsxs("div",{className:"flex flex-wrap gap-1 mb-3",children:[a.tags.slice(0,3).map((S,T)=>e.jsx("span",{className:"px-2 py-1 text-xs text-gray-600 bg-gray-100 rounded dark:bg-gray-700 dark:text-gray-400",children:S},T)),a.tags.length>3&&e.jsxs("span",{className:"px-2 py-1 text-xs text-gray-500 dark:text-gray-400",children:["+",a.tags.length-3]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3 text-xs text-gray-500 dark:text-gray-400",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx("i",{className:"mr-1 fa-solid fa-clock"}),a.estimatedTime,"分钟"]}),a.prerequisites&&a.prerequisites.length>0&&e.jsxs("span",{className:"flex items-center",children:[e.jsx("i",{className:"mr-1 fa-solid fa-link"}),a.prerequisites.length,"个前置"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>A==null?void 0:A(a),className:"px-3 py-1 text-xs text-blue-600 border border-blue-600 rounded hover:bg-blue-50 dark:text-blue-400 dark:border-blue-400 dark:hover:bg-blue-900/20",children:"开始学习"}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:()=>v==null?void 0:v(a.id,"like"),className:"p-1 text-gray-400 hover:text-green-600 dark:hover:text-green-400",title:"喜欢",children:e.jsx("i",{className:"text-xs fa-solid fa-thumbs-up"})}),e.jsx("button",{onClick:()=>v==null?void 0:v(a.id,"dislike"),className:"p-1 text-gray-400 hover:text-red-600 dark:hover:text-red-400",title:"不喜欢",children:e.jsx("i",{className:"text-xs fa-solid fa-thumbs-down"})})]})]})]})]},a.id))}),u.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[e.jsx("i",{className:"mb-4 text-5xl text-gray-400 fa-solid fa-robot"}),e.jsx("h3",{className:"mb-2 text-lg font-medium text-gray-900 dark:text-white",children:"暂无推荐内容"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"请完善您的学习档案以获得更好的推荐"})]}),e.jsx("div",{className:"flex justify-center mt-6",children:e.jsxs("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 text-sm text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 dark:text-gray-400 dark:border-gray-700 dark:hover:bg-gray-700",children:[e.jsx("i",{className:"mr-2 fa-solid fa-refresh"}),"刷新推荐"]})})]})}const re=s=>({id:s.id,symbol:s.symbol,name:s.name,category:s.category,meaning:s.description||"暂无描述",example:s.usage||"暂无示例",latex:s.latex});function de(){const[s]=r.useState(K.map(re)),[i,j]=r.useState([]),[m,A]=r.useState(""),[v,c]=r.useState("all"),[g,k]=r.useState(null),[l,f]=r.useState([]),[b,u]=r.useState(!1),[h,w]=r.useState(!0),[n,y]=r.useState(!1),[a,o]=r.useState(!1),[S,T]=r.useState(0),[E,H]=r.useState("list"),V=r.useMemo(()=>[{key:"name",weight:3,fuzzy:!0},{key:"meaning",weight:2,fuzzy:!0},{key:"symbol",weight:2,fuzzy:!1},{key:"latex",weight:1.5,fuzzy:!1},{key:"category",weight:1,fuzzy:!1}],[]),q=r.useMemo(()=>["all",...Array.from(new Set(s.map(x=>x.category)))],[s]),B=r.useCallback((t,x)=>{j(t),A(x)},[]),L=r.useMemo(()=>{let t=m?i.map(x=>x.item):s;return v!=="all"&&(t=t.filter(x=>x.category===v)),t},[s,i,m,v]),D=r.useCallback(t=>{k(t),f(x=>{const p=x.filter(R=>R.id!==t.id);return[t,...p].slice(0,10)}),T(x=>x+1),X.success(`已查看符号: ${t.name}`)},[]),d=r.useCallback(t=>{navigator.clipboard.writeText(t).then(()=>{X.success("LaTeX代码已复制到剪贴板")})},[]),C=r.useMemo(()=>({completedItems:l.map(t=>t.id.toString()),currentLevel:"intermediate",interests:["代数","几何","微积分"],learningGoals:["掌握基础符号","理解高级概念"],timePreference:30,weakAreas:["统计学","概率论"],strongAreas:["代数","几何"]}),[l]),M=r.useMemo(()=>s.slice(0,20).map(t=>({id:t.id.toString(),title:t.name,description:t.meaning,type:"symbol",difficulty:Math.random()>.6?"advanced":Math.random()>.3?"intermediate":"beginner",category:t.category,tags:[t.category,"数学符号"],relevanceScore:Math.random(),estimatedTime:Math.floor(Math.random()*20)+5,prerequisites:Math.random()>.7?[s[Math.floor(Math.random()*5)].id.toString()]:void 0})),[s]),N=r.useMemo(()=>[{topic:"基础符号",completed:l.length,total:50,category:"基础"},{topic:"高级符号",completed:Math.floor(l.length*.6),total:30,category:"进阶"},{topic:"专业符号",completed:Math.floor(l.length*.3),total:20,category:"专业"}],[l.length]),I=r.useCallback((t,x)=>{const p=i.find(R=>R.item.id===t.id);return e.jsxs("div",{className:"flex items-center p-4 transition-colors border-b border-gray-200 dark:border-gray-700 hover:bg-gray-50 dark:hover:bg-gray-700",children:[e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx("span",{className:"mr-4 font-mono text-2xl text-gray-900 dark:text-white",children:t.symbol}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-white",children:p?e.jsx("span",{dangerouslySetInnerHTML:{__html:t.name.replace(new RegExp(`(${m})`,"gi"),'<mark class="bg-yellow-200 dark:bg-yellow-800">$1</mark>')}}):t.name}),e.jsx("div",{className:"text-sm text-gray-500 dark:text-gray-400",children:p?e.jsx("span",{dangerouslySetInnerHTML:{__html:t.meaning.replace(new RegExp(`(${m})`,"gi"),'<mark class="bg-yellow-200 dark:bg-yellow-800">$1</mark>')}}):t.meaning}),e.jsx("span",{className:"inline-flex px-2 mt-1 text-xs font-semibold leading-5 text-green-800 bg-green-100 rounded-full dark:bg-green-900 dark:text-green-200",children:t.category}),p&&e.jsxs("span",{className:"ml-2 text-xs text-blue-600 dark:text-blue-400",children:["匹配度: ",Math.round(p.score*100),"%"]})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>D(t),className:"text-green-600 hover:text-green-900 dark:text-green-400 dark:hover:text-green-300",children:"查看"}),e.jsx("button",{onClick:()=>d(t.latex),className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300",children:"复制"})]})]})},[i,m,D,d]),z=r.useCallback((t,x)=>e.jsx($.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:x*.05},className:"p-4 transition-shadow bg-white border border-gray-200 rounded-lg shadow-sm hover:shadow-md dark:bg-gray-800 dark:border-gray-700",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mb-3 font-mono text-3xl text-gray-900 dark:text-white",children:t.symbol}),e.jsx("h3",{className:"mb-2 text-sm font-semibold text-gray-900 dark:text-white",children:t.name}),e.jsx("p",{className:"mb-3 text-xs text-gray-600 dark:text-gray-400 line-clamp-2",children:t.meaning}),e.jsxs("div",{className:"flex justify-center space-x-2",children:[e.jsx("button",{onClick:()=>D(t),className:"px-3 py-1 text-xs text-green-600 border border-green-600 rounded hover:bg-green-50 dark:text-green-400 dark:border-green-400 dark:hover:bg-green-900/20",children:"查看"}),e.jsx("button",{onClick:()=>d(t.latex),className:"px-3 py-1 text-xs text-blue-600 border border-blue-600 rounded hover:bg-blue-50 dark:text-blue-400 dark:border-blue-400 dark:hover:bg-blue-900/20",children:"复制"})]})]})},t.id),[D,d]);return e.jsxs("div",{className:"min-h-screen px-4 py-12 bg-gradient-to-br from-green-50 to-emerald-100 dark:from-gray-900 dark:to-gray-800 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mx-auto max-w-7xl",children:[e.jsxs($.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"mb-8 text-center",children:[e.jsx("h1",{className:"mb-4 text-4xl font-bold text-gray-900 dark:text-white",children:"高级数学符号平台"}),e.jsx("p",{className:"text-xl text-gray-600 dark:text-gray-300",children:"智能搜索 • 个性化推荐 • 数据可视化 • 性能监控"})]}),e.jsx(U,{topicId:"advanced-math-symbols",topicTitle:"高级数学符号学习",totalSteps:s.length,currentStep:S,onProgressUpdate:t=>{console.log("学习进度更新:",t)}}),e.jsx($.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},className:"p-4 mb-8 bg-white rounded-lg shadow-lg dark:bg-gray-800",children:e.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>w(!h),className:`px-4 py-2 text-sm rounded-lg transition-colors ${h?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"}`,children:[e.jsx("i",{className:"mr-2 fa-solid fa-robot"}),"智能推荐"]}),e.jsxs("button",{onClick:()=>y(!n),className:`px-4 py-2 text-sm rounded-lg transition-colors ${n?"bg-green-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"}`,children:[e.jsx("i",{className:"mr-2 fa-solid fa-chart-bar"}),"进度图表"]}),e.jsxs("button",{onClick:()=>u(!b),className:`px-4 py-2 text-sm rounded-lg transition-colors ${b?"bg-purple-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"}`,children:[e.jsx("i",{className:"mr-2 fa-solid fa-calculator"}),"公式编辑器"]})]}),e.jsx("div",{className:"flex border border-gray-300 rounded-lg dark:border-gray-700",children:["list","grid","table"].map(t=>e.jsx("button",{onClick:()=>H(t),className:`px-3 py-2 text-sm ${E===t?"bg-blue-600 text-white":"text-gray-700 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700"} ${t==="list"?"rounded-l-lg":t==="table"?"rounded-r-lg":""}`,children:e.jsx("i",{className:`fa-solid ${t==="list"?"fa-list":t==="grid"?"fa-th":"fa-table"}`})},t))})]})}),e.jsx($.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},className:"mb-8",children:e.jsx(J,{items:s,searchFields:V,onSearch:B,placeholder:"智能搜索数学符号...",className:"max-w-2xl mx-auto",showSuggestions:!0,maxSuggestions:8})}),e.jsx($.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.3},className:"mb-8",children:e.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:q.map(t=>e.jsxs("button",{onClick:()=>c(t),className:`px-4 py-2 text-sm font-medium rounded-lg transition-colors ${v===t?"bg-green-600 text-white":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50 dark:bg-gray-800 dark:text-gray-300 dark:border-gray-700 dark:hover:bg-gray-700"}`,children:[t==="all"?"全部":t,e.jsxs("span",{className:"ml-2 text-xs opacity-75",children:["(",t==="all"?s.length:s.filter(x=>x.category===t).length,")"]})]},t))})}),e.jsxs("div",{className:"space-y-8",children:[e.jsx(P,{children:h&&e.jsx($.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:e.jsx(se,{items:M,userProfile:C,maxRecommendations:6,onItemClick:t=>{const x=s.find(p=>p.id.toString()===t.id);x&&D(x)},onFeedback:(t,x)=>{X.success(`反馈已记录: ${x}`)}})})}),e.jsx(P,{children:n&&e.jsx($.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:e.jsx(ae,{progressData:N})})}),e.jsx(P,{children:b&&e.jsx($.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:e.jsx(Z,{onFormulaChange:(t,x)=>{console.log("公式变化:",t,x)}})})}),e.jsxs($.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},className:"bg-white shadow-lg dark:bg-gray-800 rounded-xl",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:["符号",E==="list"?"列表":E==="grid"?"网格":"表格","(",L.length,")"]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500 dark:text-gray-400",children:[e.jsx("i",{className:"fa-solid fa-rocket"}),e.jsx("span",{children:"高级优化"}),m&&e.jsxs("span",{className:"px-2 py-1 text-xs text-blue-800 bg-blue-100 rounded dark:bg-blue-900 dark:text-blue-200",children:["搜索: ",m]})]})]})}),L.length>0?E==="grid"?e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5",children:L.map((t,x)=>z(t,x))})}):e.jsx(O,{items:L,itemHeight:80,containerHeight:600,renderItem:I,className:"border-0"}):e.jsxs("div",{className:"flex flex-col items-center justify-center h-64",children:[e.jsx("i",{className:"mb-4 text-5xl text-gray-400 fa-solid fa-search"}),e.jsx("h3",{className:"mb-1 text-lg font-medium text-gray-900 dark:text-white",children:"未找到符号"}),e.jsx("p",{className:"max-w-md text-center text-gray-500 dark:text-gray-400",children:m?`没有找到匹配"${m}"的符号`:"当前分类下没有符号"}),e.jsx("button",{onClick:()=>{A(""),c("all")},className:"px-4 py-2 mt-4 text-sm font-medium text-blue-600 border border-blue-600 rounded-lg dark:border-blue-400 dark:text-blue-400 hover:bg-blue-50 dark:hover:bg-blue-900/20",children:"查看全部符号"})]})]}),g&&e.jsx($.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"bg-white shadow-lg dark:bg-gray-800 rounded-xl",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white",children:"符号详情"}),e.jsx("button",{onClick:()=>k(null),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300",children:e.jsx("i",{className:"fa-solid fa-times"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-20 h-20 mb-4 bg-gray-100 rounded-full dark:bg-gray-700",children:e.jsx("span",{className:"font-mono text-3xl text-gray-900 dark:text-white",children:g.symbol})}),e.jsx("h4",{className:"text-xl font-semibold text-gray-900 dark:text-white",children:g.name}),e.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:g.category})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"mb-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:"含义"}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:g.meaning})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"mb-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:"示例"}),e.jsx("p",{className:"font-mono text-sm text-gray-600 dark:text-gray-400",children:g.example})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"mb-2 text-sm font-medium text-gray-700 dark:text-gray-300",children:"LaTeX代码"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("code",{className:"flex-1 px-3 py-2 text-sm bg-gray-100 rounded dark:bg-gray-700 dark:text-gray-300",children:g.latex}),e.jsx("button",{onClick:()=>d(g.latex),className:"px-3 py-2 text-sm text-blue-600 border border-blue-600 rounded hover:bg-blue-50 dark:text-blue-400 dark:border-blue-400 dark:hover:bg-blue-900/20",children:"复制"})]})]})]})]})})]})]}),e.jsx(F,{isVisible:a,onToggle:()=>o(!a)})]})}export{de as default};
